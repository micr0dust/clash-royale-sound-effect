<!DOCTYPE html>
<html lang="zh-hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.5, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous">//jquery</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous">//popper</script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
        integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous">//bootstrap 4</script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="manifest" href="manifest.json">
    <title>皇室戰爭-音效</title>
    <style>

    </style>
</head>

<body>
    <script src="./app.js"></script>
    <nav id="navbar" class="navbar navbar-expand-md bg-dark navbar-dark text-white fixed-top">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a id="user" class="nav-link text-white">音效種類</a>
            </li>
        </ul>
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)" onclick="actions(0)">登場</a>
            </li>
            <!--
            <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)" onclick="actions(1)">移動</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)" onclick="actions(2)">攻擊</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)" onclick="actions(3)">死亡</a>
            </li>
            -->
        </ul>
    </nav>
    <br><br><br>
    <div class="container-fluid">
        <div id="cards" class="flex-grow"></div>
    </div>

    <script language="JavaScript">
        let content = "";
        let click = 0;
        var action = 0;
        for (var i = 18; i < 117; i++) {
            let str = '<img class="img-responsive img-fluid" src="./img/ia_100000' + padding(i, 3) + '.jpg" alt="Chania" onclick="playSound(this)">';
            //console.log(str);
            content += str;
            //document.write(htmlEncode(str)+"<BR>");
        }
        $('#cards').html(content);
        function padding(num, length) {
            return (Array(length).join("0") + num).slice(-length);
        }
        function htmlEncode(value) {
            return $('<div/>').text(value).html();
        }
        function playSound(obj) {
            let card = parseInt(obj.getAttribute("src").replace("./img/ia_100000", "").replace(".png", ""));
            //alert(card)
            var myaudio = new Audio('./sounds/deploy/' + card + '.mp3');
            myaudio.play();
            click++;
            openCreatePostModal();
        }
        function actions(type) {
            action = type;
        }
        serviceWorker();

        var deferredPrompt;
        window.addEventListener('beforeinstallprompt', function (event) {
            console.log('安裝視窗跳出來前 阻止它!!');
            event.preventDefault();
            deferredPrompt = event;
            return false;
        });

        function openCreatePostModal() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(function (choiceResult) {
                    console.log(choiceResult.outcome);
                    if (choiceResult.outcome == 'dismissed')
                        console.log('使用者取消安裝');
                    else
                        console.log('使用者安裝');
                });
                deferredPrompt = null;
            }
        }
    </script>
</body>

</html>